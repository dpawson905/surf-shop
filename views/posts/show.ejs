<% layout('layouts/post-show-layout') -%>

<h1><%= post.title %></h1>
<div><%= post.price %></div>
<div><%= post.description %></div>
<div><%= post.location %></div>
<div>
  <% post.images.forEach((image) => { %>
    <img src="<%= image.url %>" alt="Surf Shop Images" height="200px">
  <% }) %>
</div>
<div id='map'></div>
<div>
  <a href="/posts/<%= post.id %>/edit">
    <button>Edit Post</button>
  </a>
</div>
<div>
  <form action="/posts/<%= post.id %>?_method=DELETE" method="POST">
    <input type="submit" value="Delete">
  </form>
</div>

<h2>Create a review</h2>
<form action="/posts/<%= post.id %>/reviews" method="POST">
  <textarea name="review[body]" required></textarea>
  <input type="number" min="1" max="5" name="review[rating]" step="1" required>
  <input type="submit" value="Create Review">
</form>
<h3>Reviews</h3>
<% post.reviews.forEach((review) => { %>
  <div>
    Author: <%= review.author.username %><br>
    <%= review.body %> |
    Rating: <%= review.rating %>
  </div>
  <div>
    <button class="toggle-edit-form">Edit</button>
    <form class="edit-review-form" action="/posts/<%= post.id %>/reviews/<%= review.id %>?_method=PUT" method="POST">
      <textarea name="review[body]" required><%= review.body %></textarea>
      <input type="number" min="1" max="5" name="review[rating]" step="1" value="<%= review.rating %>" required>
      <input type="submit" value="Update Review">
    </form>
  </div>
  <hr>
<% }) %>
